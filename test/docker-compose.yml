services:
  sip_server:
    image: kamailio4sipmediagw
    build:
        dockerfile: ./Dockerfile
    container_name: kamailio
    network_mode: host
    volumes:
            - ./kamailio:/etc/kamailio:ro
            - ${CONFIG_FILE_PATH}:/etc/sipmediagw.cfg:ro
            - ./kamailio_db:/usr/local/etc/kamailio/
    logging:
      driver: syslog
      options:
        tag: "{{.ImageName}}/{{.Name}}"
    entrypoint :
        - "/bin/sh"
        - "-c"
        - "cron && kamailioRun"

  turn_server:
    image: coturn/coturn
    container_name: coturn
    network_mode: host
    logging:
      driver: syslog
      options:
        tag: "{{.ImageName}}/{{.Name}}"
    command:
        - "--log-file=stdout"
        - "--external-ip=192.168.92.1"
        - "--lt-cred-mech"
        - "--user=dmo:1234"
        - "--min-port=40000"
        - "--max-port=49999"

